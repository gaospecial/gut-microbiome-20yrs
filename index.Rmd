--- 
title: "肠道菌群研究二十年·大数据"
author: "热心肠研究院"
date: "`r Sys.Date()`"
always_allow_html: true
documentclass: ctexbook
bibliography: [book.bib, packages.bib, articles.bib]
biblio-style: apalike
link-citations: yes
colorlinks: no
lot: no
lof: no
geometry: [a4paper, tmargin=2.5cm, bmargin=2.5cm, lmargin=3.5cm, rmargin=2.5cm]
site: bookdown::bookdown_site
description: "从20年肠道菌群研究大数据看肠道菌群研究的未来"
github-repo: "gaospecial/gut-microbiome-20yrs"
#cover-image: images/cover.jpg
---

```{r setup, include=FALSE}
options(
  htmltools.dir.version = FALSE, formatR.indent = 2, width = 55, digits = 4,
  tinytex.verbose = TRUE
)

knitr::opts_chunk$set(fig.width = 8,
                      fig.asp=0.618,
                      eval=T,       # 不执行代码
                      include=TRUE, # 是否显示执行代码的结果
                      echo = FALSE, # 是否显示代码
                      message = FALSE, # 是否显示 message
                      warning = FALSE,  # 是否显示警告
                      error = FALSE, # 是否因报错而停止执行代码，设为 TRUE 表示不停止
                      cache=TRUE  # 加速预览
                      ) 

# disable Sys.setlocale output
Sys.setenv(LANG="zh_CN.UTF-8")
Sys.setenv(LANGUAGE = "en") #显示英文报错信息
Sys.setlocale(category = "LC_ALL",locale = "Chinese")

# https://stackoverflow.com/questions/32826906/how-to-solve-protection-stack-overflow-issue-in-r-studio
options(expressions = 5e5)

# 填上你需要用到的包，如 c('ggplot2', 'dplyr')
packages <- c("tidyverse","wordcloud2","mrgut","lubridate","RColorBrewer","export","gganimate","ggVennDiagram","ggraph","ccgraph")

lapply(packages, function(pkg) {
  if (system.file(package = pkg) == '') install.packages(pkg)
})
```



```{r load_pacakges}
# load frequentely used packages
library(tidyverse)
library(lubridate)
library(mrgut)
library(RColorBrewer)
library(knitr)
library(export)
library(cowplot)
library(knitr)
library(bibliometrix)
library(ggraph)
library(plotly)
library(treemap)
library(gganimate)

```

```{r colors}
# display.brewer.pal(7,"PuBuGn")
cols <- brewer.pal(n=7,name = "PuBuGn")[c(-1,-2)]
pal <- colorRampPalette(cols)
```


```{r}
# 要导出为PowerPoint的图片
graph_ppt_file <- paste0(Sys.Date(),"_graph.pptx")
```


```{r}
theme_labs <- 
  theme(plot.title = element_text(size = 12, face = "bold",hjust = 0.5),
        plot.subtitle = element_text(size = 8,
                                     hjust = 1,
                                     color = "grey50"),
        plot.caption = element_text(size=8, 
                                    hjust = 1,
                                    color = "grey50",
                                    vjust = 1,
                                    lineheight = 1.1),
        axis.text = element_text(face = "bold"),    # 标记粗体
        axis.title = element_text(face = "bold"),   # 坐标轴标题粗体
        legend.position = "none")

theme_set(theme_light() + theme_labs)
```

```{r}
# 读取全部论文数据
M <- readRDS("data/M.RDS") %>% filter(PY < 2020)

# LCS
LC <- readRDS("data/LC.RDS")

# 高引论文
highly_cited <- M %>% filter(HC==TRUE)

# 一般分析结果
results <- readRDS("data/results.RDS")
result_summary <- readRDS("data/result_summary.RDS")

```

```{r}
# country translation
data("countries")
country_translations <- rjson::fromJSON(file = "data-raw/countries/countrie.json")
country_translations <- lapply(country_translations, as_tibble)
country_translations <- do.call("rbind",country_translations)
country_translations <- country_translations %>% select(English,China,ISO2,ISO3,DIGITS)
country_translations$countries <- toupper(trim(country_translations$English))
country_multi_lang <- full_join(country_translations,countries)
```



```{r}
# 检索词：在词云分析是可以去掉的词语
query <- "TS=(gut OR intestine OR bowel OR intestinal OR colon OR colorectal OR gastrointestine OR gastrointestinal) AND TS=(microbiome OR microbiota OR flora OR microbe OR microbes OR commensal OR symbiont OR pathobiont OR mycobiome OR virome OR metagenome OR meta-genome OR bacteria OR metagenomics)"

# 检索时使用的关键词
search_keywords <- gsub("[A-Z=()]+","", query) %>% strsplit(split = "\\s+") %>% unlist() %>% unique() 
```


```{r}
## 分词时的干扰词
additional_stopwords <- "yet may one two use thus like work part either show but never non need among also however study" %>%
  strsplit(" ") %>% unlist()
```


```{r}
# 函数

# 使用鼠标相应事件
plot.ly <- function(g,...){
  ggplotly(g, tooltip = c("text"),...) %>% 
    config(displaylogo = FALSE,
           modeBarButtonsToRemove = c(
             'sendDataToCloud',
             # 'pan2d', 
             'select2d', 
             'lasso2d',
             'toggleSpikelines',
             'hoverClosestCartesian',
             'hoverCompareCartesian'
           ))
}
```


```{r}
# 重新开始时，需要先运行以上代码
```


# 前言 {-}

[北京热心肠生物技术研究院有限公司](https://www.mr-gut.cn/about)是致力于链接科学与商业的盈利型研究院。我们立足于链接肠道领域的学者、医生、企业家、政府和媒体人士，为受众提供包括在线知识库、落地活动、科普自媒体内容、产业动态及分析等在内的多种满足肠道行业需求的服务，同时通过企业服务和联名产品等方式获得收入与盈利。

作为热心肠研究院最为知名的产品之一，《热心肠日报》持续追踪“肠道菌群”研究进展已经有四年了。在四年的持续输出下，《日报》已经成为广大用户了解相关研究进展的一个窗口，受到很多老师、同学的喜爱和赞誉。但我们深知，《日报》仅能管中窥豹，难免会有错漏之处。在2019年底，在“肠道菌群研究的七大事实和五大倡议”一文创作期间，我们下载分析了 Web of Science 数据库中“肠道菌群”研究的全部论文数据，为文章提供数据支撑。

蓦然回首，特别是2008年美国国立卫生研究院（NIH）率先提出人体微生物组计划[^1]以来，“肠道菌群”已经兴起了十余年。而“肠道菌群”的研究岂止于此，2019年6月 Nature 杂志特别总结了“人类微生物组”研究的里程碑事件，将研究追溯到最早 1944 年的厌氧微生物分离培养 [@clarkCulturingAnaerobes2019]。

热心肠研究院长期关注“肠道”，并将“**让人们拥有更健康的肠道**”作为公司的使命。在进入 2020 年的最初几天，我们很快有一个想法，就是以“肠道菌群”研究这一人体微生物组研究的主要领域为切入点，系统调研过去二十年“肠道菌群”研究的发展历程，从数据层面展示“肠道菌群”研究的全景、国际研究格局和研究热点的变迁等，为未来的“肠道菌群”研究提供参考，为未来的“肠道产业”发展理清方向。

[^1]: 关于人类微生物组计划的一般常识，请参见[维基百科](https://en.wikipedia.org/wiki/Human_Microbiome_Project)，[百度百科](https://baike.baidu.com/item/%E4%BA%BA%E7%B1%BB%E5%BE%AE%E7%94%9F%E7%89%A9%E7%BB%84%E8%AE%A1%E5%88%92/10745945)。

于是，我们写了一本书。这本书是这样的，第一部分是“肠道菌群”研究的概述，包括第 \@ref(intro) 章，介绍了肠道菌群研究的概述；第二部分是国际研究格局，包括第 \@ref(global) - \@ref(china-study) 章，分别介绍研究的国际协作、不同国家主要的研究力量的分布、主要的科学研究中心（机构、高校等）和研究团队等；第三部分是主要的研究发现和变迁，包括第 \@ref(milestone) - \@ref(CVD) 章，对“肠道菌群”研究取得的主要成果及其研究的脉络进行阐述。

本书的写作遵循**可重复研究**的范式，我们采用的主要研究手段是文献计量学方法，基于 **bibliometrix**\index{bibliometrix} [@R-bibliometrix] 和 R 语言数据科学工具包提供的方法 **tidyverse**\index{tidyverse} [@R-tidyverse] 和可视化工具 **ggraph**\index{ggraph} [@R-ggraph] 等。分析的数据来自于 Web of Science 数据库的核心合集（参见附录\@ref(data-source)）。最终，我用了两个 R 包编译这本书，分别是 **knitr**\index{knitr} [@xie2015] 和 **bookdown**\index{bookdown} [@R-bookdown]。下面附上我的 R 进程信息，以便相关人士查询：

```{r include=TRUE}
sessionInfo()
```

## 致谢 {-}

非常感谢科睿唯安公司的郭老师以及中科院微生物研究所王军研究员对我们的帮助。

```{block2, type='flushright', html.tag='p'}
本书编者
```

